'use strict';

exports.__esModule = true;
exports.default = pureStateless;

var _shallowEqual = require('./shallowEqual');

var _shallowEqual2 = _interopRequireDefault(_shallowEqual);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function pureStateless(statelessComponent) {

  var lastProps = undefined,
      lastContext = undefined,
      savedResult = undefined,
      savedException = undefined;

  return function (props, context) {
    var shouldUpdate = !(0, _shallowEqual2.default)(props, lastProps) || !(0, _shallowEqual2.default)(context, lastContext);

    if (shouldUpdate) {
      lastProps = props;
      lastContext = context;

      savedResult = undefined;
      savedException = undefined;

      try {
        savedResult = statelessComponent.apply(this, arguments);
      } catch (e) {
        savedException = e;
      }
    }

    if (savedException !== undefined) {
      throw savedException;
    }

    return savedResult;
  };
}